<template><div><h1 id="åº”ç”¨ç®¡ç†-api" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨ç®¡ç†-api">#</a> åº”ç”¨ç®¡ç† API</h1>
<p>åº”ç”¨ç®¡ç†APIæä¾›äº†å®Œæ•´çš„åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬åº”ç”¨çš„åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œã€‚åº”ç”¨æ˜¯VGOç³»ç»Ÿä¸­çš„é‡è¦æ¦‚å¿µï¼Œç”¨äºç»„ç»‡å’Œç®¡ç†ç›¸å…³çš„ç”¨æˆ·ã€ç­–ç•¥å’Œè®¿é—®å¯†é’¥ã€‚</p>
<h2 id="ğŸ“‹-api-æ¦‚è§ˆ" tabindex="-1"><a class="header-anchor" href="#ğŸ“‹-api-æ¦‚è§ˆ">#</a> ğŸ“‹ API æ¦‚è§ˆ</h2>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
<th>æƒé™è¦æ±‚</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>CreateApplication</code></td>
<td>åˆ›å»ºåº”ç”¨</td>
<td><code v-pre>iam:CreateApplication</code></td>
</tr>
<tr>
<td><code v-pre>GetApplication</code></td>
<td>è·å–åº”ç”¨è¯¦æƒ…</td>
<td><code v-pre>iam:GetApplication</code></td>
</tr>
<tr>
<td><code v-pre>UpdateApplication</code></td>
<td>æ›´æ–°åº”ç”¨ä¿¡æ¯</td>
<td><code v-pre>iam:UpdateApplication</code></td>
</tr>
<tr>
<td><code v-pre>DeleteApplication</code></td>
<td>åˆ é™¤åº”ç”¨</td>
<td><code v-pre>iam:DeleteApplication</code></td>
</tr>
<tr>
<td><code v-pre>ListApplications</code></td>
<td>è·å–åº”ç”¨åˆ—è¡¨</td>
<td><code v-pre>iam:ListApplications</code></td>
</tr>
</tbody>
</table>
<h2 id="ğŸ”§-api-è¯¦æƒ…" tabindex="-1"><a class="header-anchor" href="#ğŸ”§-api-è¯¦æƒ…">#</a> ğŸ”§ API è¯¦æƒ…</h2>
<h3 id="createapplication-åˆ›å»ºåº”ç”¨" tabindex="-1"><a class="header-anchor" href="#createapplication-åˆ›å»ºåº”ç”¨">#</a> CreateApplication - åˆ›å»ºåº”ç”¨</h3>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨å®ä¾‹ã€‚</p>
<h4 id="è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚">#</a> è¯·æ±‚</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">CreateApplicationRequest</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>              <span class="token comment">// åº”ç”¨åç§°ï¼ˆå¿…éœ€ï¼Œå”¯ä¸€ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> description <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>       <span class="token comment">// åº”ç”¨æè¿°ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> homepage_url <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>      <span class="token comment">// ä¸»é¡µURLï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> callback_url <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>      <span class="token comment">// å›è°ƒURLï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token positional-class-name class-name">ApplicationType</span> type <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>     <span class="token comment">// åº”ç”¨ç±»å‹ï¼ˆå¿…éœ€ï¼‰</span></span>
<span class="line">  <span class="token keyword">repeated</span> <span class="token builtin">string</span> scopes <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>   <span class="token comment">// æƒé™èŒƒå›´ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”" tabindex="-1"><a class="header-anchor" href="#å“åº”">#</a> å“åº”</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">CreateApplicationResponse</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token positional-class-name class-name">Application</span> application <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">// åˆ›å»ºçš„åº”ç”¨ä¿¡æ¯</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹">#</a> ç¤ºä¾‹</h4>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># åˆ›å»ºWebåº”ç”¨</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "name": "my-web-app",</span>
<span class="line">  "description": "æˆ‘çš„Webåº”ç”¨",</span>
<span class="line">  "homepage_url": "https://example.com",</span>
<span class="line">  "callback_url": "https://example.com/callback",</span>
<span class="line">  "type": "APPLICATION_TYPE_WEB",</span>
<span class="line">  "scopes": ["read", "write"]</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/CreateApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># åˆ›å»ºç§»åŠ¨åº”ç”¨</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "name": "my-mobile-app",</span>
<span class="line">  "description": "æˆ‘çš„ç§»åŠ¨åº”ç”¨",</span>
<span class="line">  "type": "APPLICATION_TYPE_MOBILE",</span>
<span class="line">  "scopes": ["read", "write", "offline_access"]</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/CreateApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å“åº”ç¤ºä¾‹">#</a> å“åº”ç¤ºä¾‹</h4>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"application"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"app-123456"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-web-app"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"æˆ‘çš„Webåº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"homepage_url"</span><span class="token operator">:</span> <span class="token string">"https://example.com"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"callback_url"</span><span class="token operator">:</span> <span class="token string">"https://example.com/callback"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_TYPE_WEB"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_STATUS_ACTIVE"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"client_id"</span><span class="token operator">:</span> <span class="token string">"client_1234567890abcdef"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"client_secret"</span><span class="token operator">:</span> <span class="token string">"secret_abcdef1234567890"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"created_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-01T00:00:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"updated_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-01T00:00:00Z"</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning">
<p class="hint-container-title">é‡è¦æç¤º</p>
<p><code v-pre>client_secret</code> åªåœ¨åˆ›å»ºæ—¶è¿”å›ä¸€æ¬¡ï¼Œè¯·å¦¥å–„ä¿å­˜ã€‚åç»­æ— æ³•å†æ¬¡è·å–ã€‚</p>
</div>
<h4 id="é”™è¯¯æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯æƒ…å†µ">#</a> é”™è¯¯æƒ…å†µ</h4>
<table>
<thead>
<tr>
<th>é”™è¯¯ç </th>
<th>è¯´æ˜</th>
<th>è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>ALREADY_EXISTS</code></td>
<td>åº”ç”¨åç§°å·²å­˜åœ¨</td>
<td>ä½¿ç”¨ä¸åŒçš„åº”ç”¨åç§°</td>
</tr>
<tr>
<td><code v-pre>INVALID_ARGUMENT</code></td>
<td>æ— æ•ˆçš„URLæ ¼å¼</td>
<td>æ£€æŸ¥URLæ ¼å¼æ˜¯å¦æ­£ç¡®</td>
</tr>
<tr>
<td><code v-pre>INVALID_ARGUMENT</code></td>
<td>æ— æ•ˆçš„åº”ç”¨ç±»å‹</td>
<td>ä½¿ç”¨æœ‰æ•ˆçš„åº”ç”¨ç±»å‹</td>
</tr>
<tr>
<td><code v-pre>PERMISSION_DENIED</code></td>
<td>æ— åˆ›å»ºåº”ç”¨æƒé™</td>
<td>ç¡®ä¿æœ‰<code v-pre>iam:CreateApplication</code>æƒé™</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="getapplication-è·å–åº”ç”¨è¯¦æƒ…" tabindex="-1"><a class="header-anchor" href="#getapplication-è·å–åº”ç”¨è¯¦æƒ…">#</a> GetApplication - è·å–åº”ç”¨è¯¦æƒ…</h3>
<p>æ ¹æ®åº”ç”¨IDæˆ–åç§°è·å–åº”ç”¨çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
<h4 id="è¯·æ±‚-1" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚-1">#</a> è¯·æ±‚</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">GetApplicationRequest</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">oneof</span> identifier <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin">string</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>              <span class="token comment">// åº”ç”¨ID</span></span>
<span class="line">    <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token comment">// åº”ç”¨åç§°</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”-1" tabindex="-1"><a class="header-anchor" href="#å“åº”-1">#</a> å“åº”</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">GetApplicationResponse</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token positional-class-name class-name">Application</span> application <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">// åº”ç”¨ä¿¡æ¯</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-1">#</a> ç¤ºä¾‹</h4>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># é€šè¿‡IDè·å–åº”ç”¨</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "id": "app-123456"</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/GetApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># é€šè¿‡åç§°è·å–åº”ç”¨</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "name": "my-web-app"</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/GetApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#å“åº”ç¤ºä¾‹-1">#</a> å“åº”ç¤ºä¾‹</h4>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"application"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"app-123456"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-web-app"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"æˆ‘çš„Webåº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"homepage_url"</span><span class="token operator">:</span> <span class="token string">"https://example.com"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"callback_url"</span><span class="token operator">:</span> <span class="token string">"https://example.com/callback"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_TYPE_WEB"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_STATUS_ACTIVE"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"client_id"</span><span class="token operator">:</span> <span class="token string">"client_1234567890abcdef"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"created_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-01T00:00:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"updated_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-01T00:00:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"last_used_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-15T10:30:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"user_count"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"access_key_count"</span><span class="token operator">:</span> <span class="token number">5</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip">
<p class="hint-container-title">æç¤º</p>
<p>å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè·å–æ¥å£ä¸è¿”å› <code v-pre>client_secret</code> å­—æ®µã€‚</p>
</div>
<h4 id="é”™è¯¯æƒ…å†µ-1" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯æƒ…å†µ-1">#</a> é”™è¯¯æƒ…å†µ</h4>
<table>
<thead>
<tr>
<th>é”™è¯¯ç </th>
<th>è¯´æ˜</th>
<th>è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>NOT_FOUND</code></td>
<td>åº”ç”¨ä¸å­˜åœ¨</td>
<td>ç¡®è®¤åº”ç”¨IDæˆ–åç§°æ­£ç¡®</td>
</tr>
<tr>
<td><code v-pre>INVALID_ARGUMENT</code></td>
<td>ç¼ºå°‘æ ‡è¯†ç¬¦</td>
<td>æä¾›åº”ç”¨IDæˆ–åç§°</td>
</tr>
<tr>
<td><code v-pre>PERMISSION_DENIED</code></td>
<td>æ— æŸ¥çœ‹åº”ç”¨æƒé™</td>
<td>ç¡®ä¿æœ‰<code v-pre>iam:GetApplication</code>æƒé™</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="updateapplication-æ›´æ–°åº”ç”¨ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#updateapplication-æ›´æ–°åº”ç”¨ä¿¡æ¯">#</a> UpdateApplication - æ›´æ–°åº”ç”¨ä¿¡æ¯</h3>
<p>æ›´æ–°åº”ç”¨çš„åŸºæœ¬ä¿¡æ¯ã€çŠ¶æ€æˆ–é…ç½®ã€‚</p>
<h4 id="è¯·æ±‚-2" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚-2">#</a> è¯·æ±‚</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">UpdateApplicationRequest</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">string</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                        <span class="token comment">// åº”ç”¨IDï¼ˆå¿…éœ€ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>                      <span class="token comment">// æ–°åç§°ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> description <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>               <span class="token comment">// æ–°æè¿°ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> homepage_url <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>              <span class="token comment">// æ–°ä¸»é¡µURLï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> callback_url <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>              <span class="token comment">// æ–°å›è°ƒURLï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token positional-class-name class-name">ApplicationStatus</span> status <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>         <span class="token comment">// æ–°çŠ¶æ€ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token keyword">repeated</span> <span class="token builtin">string</span> scopes <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>           <span class="token comment">// æ–°æƒé™èŒƒå›´ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token positional-class-name class-name">google<span class="token punctuation">.</span>protobuf<span class="token punctuation">.</span>FieldMask</span> update_mask <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>  <span class="token comment">// æ›´æ–°å­—æ®µæ©ç </span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”-2" tabindex="-1"><a class="header-anchor" href="#å“åº”-2">#</a> å“åº”</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">UpdateApplicationResponse</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token positional-class-name class-name">Application</span> application <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>          <span class="token comment">// æ›´æ–°åçš„åº”ç”¨ä¿¡æ¯</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-2">#</a> ç¤ºä¾‹</h4>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># æ›´æ–°åº”ç”¨æè¿°</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "id": "app-123456",</span>
<span class="line">  "description": "æ›´æ–°åçš„åº”ç”¨æè¿°",</span>
<span class="line">  "update_mask": {</span>
<span class="line">    "paths": ["description"]</span>
<span class="line">  }</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/UpdateApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># ç¦ç”¨åº”ç”¨</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "id": "app-123456",</span>
<span class="line">  "status": "APPLICATION_STATUS_INACTIVE",</span>
<span class="line">  "update_mask": {</span>
<span class="line">    "paths": ["status"]</span>
<span class="line">  }</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/UpdateApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># æ›´æ–°å¤šä¸ªå­—æ®µ</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "id": "app-123456",</span>
<span class="line">  "description": "å…¨æ–°çš„åº”ç”¨æè¿°",</span>
<span class="line">  "homepage_url": "https://newdomain.com",</span>
<span class="line">  "scopes": ["read", "write", "admin"],</span>
<span class="line">  "update_mask": {</span>
<span class="line">    "paths": ["description", "homepage_url", "scopes"]</span>
<span class="line">  }</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/UpdateApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”ç¤ºä¾‹-2" tabindex="-1"><a class="header-anchor" href="#å“åº”ç¤ºä¾‹-2">#</a> å“åº”ç¤ºä¾‹</h4>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"application"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"app-123456"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-web-app"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"æ›´æ–°åçš„åº”ç”¨æè¿°"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"homepage_url"</span><span class="token operator">:</span> <span class="token string">"https://newdomain.com"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"callback_url"</span><span class="token operator">:</span> <span class="token string">"https://example.com/callback"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_TYPE_WEB"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_STATUS_ACTIVE"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"admin"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"client_id"</span><span class="token operator">:</span> <span class="token string">"client_1234567890abcdef"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"created_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-01T00:00:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"updated_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-15T14:30:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"last_used_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-15T10:30:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"user_count"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"access_key_count"</span><span class="token operator">:</span> <span class="token number">5</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é”™è¯¯æƒ…å†µ-2" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯æƒ…å†µ-2">#</a> é”™è¯¯æƒ…å†µ</h4>
<table>
<thead>
<tr>
<th>é”™è¯¯ç </th>
<th>è¯´æ˜</th>
<th>è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>NOT_FOUND</code></td>
<td>åº”ç”¨ä¸å­˜åœ¨</td>
<td>ç¡®è®¤åº”ç”¨IDæ­£ç¡®</td>
</tr>
<tr>
<td><code v-pre>ALREADY_EXISTS</code></td>
<td>æ–°åç§°å·²è¢«ä½¿ç”¨</td>
<td>ä½¿ç”¨ä¸åŒçš„åº”ç”¨åç§°</td>
</tr>
<tr>
<td><code v-pre>INVALID_ARGUMENT</code></td>
<td>æ— æ•ˆçš„URLæ ¼å¼</td>
<td>æ£€æŸ¥URLæ ¼å¼æ˜¯å¦æ­£ç¡®</td>
</tr>
<tr>
<td><code v-pre>PERMISSION_DENIED</code></td>
<td>æ— æ›´æ–°åº”ç”¨æƒé™</td>
<td>ç¡®ä¿æœ‰<code v-pre>iam:UpdateApplication</code>æƒé™</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="deleteapplication-åˆ é™¤åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#deleteapplication-åˆ é™¤åº”ç”¨">#</a> DeleteApplication - åˆ é™¤åº”ç”¨</h3>
<p>åˆ é™¤æŒ‡å®šçš„åº”ç”¨ã€‚</p>
<div class="hint-container warning">
<p class="hint-container-title">æ³¨æ„</p>
<p>åˆ é™¤åº”ç”¨æ˜¯ä¸å¯é€†æ“ä½œï¼Œä¼šåŒæ—¶åˆ é™¤å…³è”çš„è®¿é—®å¯†é’¥å’Œç”¨æˆ·ç»‘å®šå…³ç³»ã€‚</p>
</div>
<h4 id="è¯·æ±‚-3" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚-3">#</a> è¯·æ±‚</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">DeleteApplicationRequest</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">string</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token comment">// åº”ç”¨IDï¼ˆå¿…éœ€ï¼‰</span></span>
<span class="line">  <span class="token builtin">bool</span> force <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>               <span class="token comment">// å¼ºåˆ¶åˆ é™¤ï¼ˆå¯é€‰ï¼Œé»˜è®¤falseï¼‰</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”-3" tabindex="-1"><a class="header-anchor" href="#å“åº”-3">#</a> å“åº”</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">DeleteApplicationResponse</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ç©ºå“åº”ï¼ŒæˆåŠŸæ—¶æ— è¿”å›å†…å®¹</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-3">#</a> ç¤ºä¾‹</h4>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># åˆ é™¤åº”ç”¨ï¼ˆå¦‚æœæœ‰å…³è”èµ„æºä¼šå¤±è´¥ï¼‰</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "id": "app-123456"</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/DeleteApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># å¼ºåˆ¶åˆ é™¤åº”ç”¨ï¼ˆåˆ é™¤æ‰€æœ‰å…³è”èµ„æºï¼‰</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "id": "app-123456",</span>
<span class="line">  "force": true</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/DeleteApplication</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”ç¤ºä¾‹-3" tabindex="-1"><a class="header-anchor" href="#å“åº”ç¤ºä¾‹-3">#</a> å“åº”ç¤ºä¾‹</h4>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h4 id="é”™è¯¯æƒ…å†µ-3" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯æƒ…å†µ-3">#</a> é”™è¯¯æƒ…å†µ</h4>
<table>
<thead>
<tr>
<th>é”™è¯¯ç </th>
<th>è¯´æ˜</th>
<th>è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>NOT_FOUND</code></td>
<td>åº”ç”¨ä¸å­˜åœ¨</td>
<td>ç¡®è®¤åº”ç”¨IDæ­£ç¡®</td>
</tr>
<tr>
<td><code v-pre>FAILED_PRECONDITION</code></td>
<td>åº”ç”¨æœ‰å…³è”èµ„æº</td>
<td>å…ˆåˆ é™¤å…³è”èµ„æºæˆ–ä½¿ç”¨force=true</td>
</tr>
<tr>
<td><code v-pre>PERMISSION_DENIED</code></td>
<td>æ— åˆ é™¤åº”ç”¨æƒé™</td>
<td>ç¡®ä¿æœ‰<code v-pre>iam:DeleteApplication</code>æƒé™</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="listapplications-è·å–åº”ç”¨åˆ—è¡¨" tabindex="-1"><a class="header-anchor" href="#listapplications-è·å–åº”ç”¨åˆ—è¡¨">#</a> ListApplications - è·å–åº”ç”¨åˆ—è¡¨</h3>
<p>è·å–åº”ç”¨åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œè¿‡æ»¤ã€‚</p>
<h4 id="è¯·æ±‚-4" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚-4">#</a> è¯·æ±‚</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">ListApplicationsRequest</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token positional-class-name class-name">ApplicationType</span> type <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">// åº”ç”¨ç±»å‹è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token positional-class-name class-name">ApplicationStatus</span> status <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// åº”ç”¨çŠ¶æ€è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> name_filter <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>       <span class="token comment">// åç§°è¿‡æ»¤ï¼ˆæ”¯æŒæ¨¡ç³ŠåŒ¹é…ï¼‰</span></span>
<span class="line">  <span class="token builtin">int32</span> page <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>              <span class="token comment">// é¡µç ï¼ˆä»1å¼€å§‹ï¼‰</span></span>
<span class="line">  <span class="token builtin">int32</span> page_size <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>         <span class="token comment">// æ¯é¡µå¤§å°ï¼ˆæœ€å¤§100ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> sort_by <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>          <span class="token comment">// æ’åºå­—æ®µï¼ˆname, created_at, updated_atï¼‰</span></span>
<span class="line">  <span class="token builtin">bool</span> sort_desc <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>          <span class="token comment">// æ˜¯å¦é™åºæ’åˆ—</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”-4" tabindex="-1"><a class="header-anchor" href="#å“åº”-4">#</a> å“åº”</h4>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">ListApplicationsResponse</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Application</span> applications <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// åº”ç”¨åˆ—è¡¨</span></span>
<span class="line">  <span class="token positional-class-name class-name">Pagination</span> pagination <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>              <span class="token comment">// åˆ†é¡µä¿¡æ¯</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-4">#</a> ç¤ºä¾‹</h4>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># è·å–æ‰€æœ‰åº”ç”¨</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "page": 1,</span>
<span class="line">  "page_size": 10</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/ListApplications</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># è·å–Webåº”ç”¨</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "type": "APPLICATION_TYPE_WEB",</span>
<span class="line">  "page": 1,</span>
<span class="line">  "page_size": 10</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/ListApplications</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token comment"># æœç´¢åº”ç”¨åç§°åŒ…å«"api"çš„åº”ç”¨</span></span>
<span class="line">grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">  "name_filter": "api",</span>
<span class="line">  "sort_by": "created_at",</span>
<span class="line">  "sort_desc": true,</span>
<span class="line">  "page": 1,</span>
<span class="line">  "page_size": 20</span>
<span class="line">}'</span> localhost:50051 iam.v1.IAM/ListApplications</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å“åº”ç¤ºä¾‹-4" tabindex="-1"><a class="header-anchor" href="#å“åº”ç¤ºä¾‹-4">#</a> å“åº”ç¤ºä¾‹</h4>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"applications"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"app-123456"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-web-app"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"æˆ‘çš„Webåº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"homepage_url"</span><span class="token operator">:</span> <span class="token string">"https://example.com"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_TYPE_WEB"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_STATUS_ACTIVE"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"client_id"</span><span class="token operator">:</span> <span class="token string">"client_1234567890abcdef"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"created_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-01T00:00:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"updated_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-15T14:30:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"last_used_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-15T10:30:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"user_count"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"access_key_count"</span><span class="token operator">:</span> <span class="token number">5</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"app-789012"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-api-service"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"APIæœåŠ¡åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_TYPE_SERVICE"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"status"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_STATUS_ACTIVE"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"admin"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"client_id"</span><span class="token operator">:</span> <span class="token string">"client_0987654321fedcba"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"created_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-10T00:00:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"updated_at"</span><span class="token operator">:</span> <span class="token string">"2024-01-10T00:00:00Z"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"user_count"</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"access_key_count"</span><span class="token operator">:</span> <span class="token number">2</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">"pagination"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">"page"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"page_size"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"total_count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">"total_pages"</span><span class="token operator">:</span> <span class="token number">1</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é”™è¯¯æƒ…å†µ-4" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯æƒ…å†µ-4">#</a> é”™è¯¯æƒ…å†µ</h4>
<table>
<thead>
<tr>
<th>é”™è¯¯ç </th>
<th>è¯´æ˜</th>
<th>è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>INVALID_ARGUMENT</code></td>
<td>æ— æ•ˆçš„åˆ†é¡µå‚æ•°</td>
<td>æ£€æŸ¥pageå’Œpage_sizeå€¼</td>
</tr>
<tr>
<td><code v-pre>INVALID_ARGUMENT</code></td>
<td>æ— æ•ˆçš„æ’åºå­—æ®µ</td>
<td>ä½¿ç”¨æœ‰æ•ˆçš„æ’åºå­—æ®µ</td>
</tr>
<tr>
<td><code v-pre>PERMISSION_DENIED</code></td>
<td>æ— æŸ¥çœ‹åº”ç”¨åˆ—è¡¨æƒé™</td>
<td>ç¡®ä¿æœ‰<code v-pre>iam:ListApplications</code>æƒé™</td>
</tr>
</tbody>
</table>
<h2 id="ğŸ“Š-æ•°æ®æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#ğŸ“Š-æ•°æ®æ¨¡å‹">#</a> ğŸ“Š æ•°æ®æ¨¡å‹</h2>
<h3 id="application-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#application-å¯¹è±¡">#</a> Application å¯¹è±¡</h3>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">message</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">string</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                        <span class="token comment">// åº”ç”¨IDï¼ˆç³»ç»Ÿç”Ÿæˆï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>                      <span class="token comment">// åº”ç”¨åç§°ï¼ˆå”¯ä¸€ï¼‰</span></span>
<span class="line">  <span class="token builtin">string</span> description <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>               <span class="token comment">// åº”ç”¨æè¿°</span></span>
<span class="line">  <span class="token builtin">string</span> homepage_url <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>              <span class="token comment">// ä¸»é¡µURL</span></span>
<span class="line">  <span class="token builtin">string</span> callback_url <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>              <span class="token comment">// å›è°ƒURL</span></span>
<span class="line">  <span class="token positional-class-name class-name">ApplicationType</span> type <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>             <span class="token comment">// åº”ç”¨ç±»å‹</span></span>
<span class="line">  <span class="token positional-class-name class-name">ApplicationStatus</span> status <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>         <span class="token comment">// åº”ç”¨çŠ¶æ€</span></span>
<span class="line">  <span class="token keyword">repeated</span> <span class="token builtin">string</span> scopes <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>           <span class="token comment">// æƒé™èŒƒå›´</span></span>
<span class="line">  <span class="token builtin">string</span> client_id <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>                 <span class="token comment">// å®¢æˆ·ç«¯ID</span></span>
<span class="line">  <span class="token builtin">string</span> client_secret <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>            <span class="token comment">// å®¢æˆ·ç«¯å¯†é’¥ï¼ˆä»…åˆ›å»ºæ—¶è¿”å›ï¼‰</span></span>
<span class="line">  <span class="token positional-class-name class-name">google<span class="token punctuation">.</span>protobuf<span class="token punctuation">.</span>Timestamp</span> created_at <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>    <span class="token comment">// åˆ›å»ºæ—¶é—´</span></span>
<span class="line">  <span class="token positional-class-name class-name">google<span class="token punctuation">.</span>protobuf<span class="token punctuation">.</span>Timestamp</span> updated_at <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>    <span class="token comment">// æ›´æ–°æ—¶é—´</span></span>
<span class="line">  <span class="token positional-class-name class-name">google<span class="token punctuation">.</span>protobuf<span class="token punctuation">.</span>Timestamp</span> last_used_at <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>  <span class="token comment">// æœ€åä½¿ç”¨æ—¶é—´</span></span>
<span class="line">  <span class="token builtin">int32</span> user_count <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span>                <span class="token comment">// å…³è”ç”¨æˆ·æ•°</span></span>
<span class="line">  <span class="token builtin">int32</span> access_key_count <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>          <span class="token comment">// è®¿é—®å¯†é’¥æ•°</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="applicationtype-æšä¸¾" tabindex="-1"><a class="header-anchor" href="#applicationtype-æšä¸¾">#</a> ApplicationType æšä¸¾</h3>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">enum</span> <span class="token class-name">ApplicationType</span> <span class="token punctuation">{</span></span>
<span class="line">  APPLICATION_TYPE_UNSPECIFIED <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token comment">// æœªæŒ‡å®š</span></span>
<span class="line">  APPLICATION_TYPE_WEB <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>             <span class="token comment">// Webåº”ç”¨</span></span>
<span class="line">  APPLICATION_TYPE_MOBILE <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>          <span class="token comment">// ç§»åŠ¨åº”ç”¨</span></span>
<span class="line">  APPLICATION_TYPE_DESKTOP <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>         <span class="token comment">// æ¡Œé¢åº”ç”¨</span></span>
<span class="line">  APPLICATION_TYPE_SERVICE <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>         <span class="token comment">// æœåŠ¡åº”ç”¨</span></span>
<span class="line">  APPLICATION_TYPE_SPA <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>             <span class="token comment">// å•é¡µåº”ç”¨</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="applicationstatus-æšä¸¾" tabindex="-1"><a class="header-anchor" href="#applicationstatus-æšä¸¾">#</a> ApplicationStatus æšä¸¾</h3>
<div class="language-protobuf line-numbers-mode" data-highlighter="prismjs" data-ext="protobuf"><pre v-pre><code class="language-protobuf"><span class="line"><span class="token keyword">enum</span> <span class="token class-name">ApplicationStatus</span> <span class="token punctuation">{</span></span>
<span class="line">  APPLICATION_STATUS_UNSPECIFIED <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">// æœªæŒ‡å®š</span></span>
<span class="line">  APPLICATION_STATUS_ACTIVE <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token comment">// æ´»è·ƒ</span></span>
<span class="line">  APPLICATION_STATUS_INACTIVE <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>      <span class="token comment">// éæ´»è·ƒ</span></span>
<span class="line">  APPLICATION_STATUS_SUSPENDED <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>     <span class="token comment">// æš‚åœ</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ”-æƒé™è¦æ±‚" tabindex="-1"><a class="header-anchor" href="#ğŸ”-æƒé™è¦æ±‚">#</a> ğŸ” æƒé™è¦æ±‚</h2>
<h3 id="æ‰€éœ€æƒé™" tabindex="-1"><a class="header-anchor" href="#æ‰€éœ€æƒé™">#</a> æ‰€éœ€æƒé™</h3>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>æƒé™</th>
<th>èµ„æº</th>
</tr>
</thead>
<tbody>
<tr>
<td>åˆ›å»ºåº”ç”¨</td>
<td><code v-pre>iam:CreateApplication</code></td>
<td><code v-pre>arn:iam::application/*</code></td>
</tr>
<tr>
<td>è·å–åº”ç”¨</td>
<td><code v-pre>iam:GetApplication</code></td>
<td><code v-pre>arn:iam::application/*</code> æˆ– <code v-pre>arn:iam::application/${app:id}</code></td>
</tr>
<tr>
<td>æ›´æ–°åº”ç”¨</td>
<td><code v-pre>iam:UpdateApplication</code></td>
<td><code v-pre>arn:iam::application/*</code> æˆ– <code v-pre>arn:iam::application/${app:id}</code></td>
</tr>
<tr>
<td>åˆ é™¤åº”ç”¨</td>
<td><code v-pre>iam:DeleteApplication</code></td>
<td><code v-pre>arn:iam::application/*</code> æˆ– <code v-pre>arn:iam::application/${app:id}</code></td>
</tr>
<tr>
<td>åˆ—è¡¨åº”ç”¨</td>
<td><code v-pre>iam:ListApplications</code></td>
<td><code v-pre>arn:iam::application/*</code></td>
</tr>
</tbody>
</table>
<h3 id="ç­–ç•¥ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç­–ç•¥ç¤ºä¾‹">#</a> ç­–ç•¥ç¤ºä¾‹</h3>
<h4 id="åº”ç”¨å¼€å‘è€…ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨å¼€å‘è€…ç­–ç•¥">#</a> åº”ç”¨å¼€å‘è€…ç­–ç•¥</h4>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"Version"</span><span class="token operator">:</span> <span class="token string">"2025-01-01"</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">"Statement"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"Effect"</span><span class="token operator">:</span> <span class="token string">"Allow"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"Action"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token string">"iam:CreateApplication"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"iam:GetApplication"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"iam:UpdateApplication"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"iam:ListApplications"</span></span>
<span class="line">      <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"Resource"</span><span class="token operator">:</span> <span class="token string">"arn:iam::application/*"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"Condition"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token property">"StringEquals"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token property">"iam:ApplicationOwner"</span><span class="token operator">:</span> <span class="token string">"${aws:username}"</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åº”ç”¨ç®¡ç†å‘˜ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨ç®¡ç†å‘˜ç­–ç•¥">#</a> åº”ç”¨ç®¡ç†å‘˜ç­–ç•¥</h4>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"Version"</span><span class="token operator">:</span> <span class="token string">"2025-01-01"</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">"Statement"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"Effect"</span><span class="token operator">:</span> <span class="token string">"Allow"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"Action"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token string">"iam:CreateApplication"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"iam:GetApplication"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"iam:UpdateApplication"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"iam:DeleteApplication"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"iam:ListApplications"</span></span>
<span class="line">      <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"Resource"</span><span class="token operator">:</span> <span class="token string">"*"</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åªè¯»è®¿é—®ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#åªè¯»è®¿é—®ç­–ç•¥">#</a> åªè¯»è®¿é—®ç­–ç•¥</h4>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"Version"</span><span class="token operator">:</span> <span class="token string">"2025-01-01"</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">"Statement"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"Effect"</span><span class="token operator">:</span> <span class="token string">"Allow"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"Action"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token string">"iam:GetApplication"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"iam:ListApplications"</span></span>
<span class="line">      <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"Resource"</span><span class="token operator">:</span> <span class="token string">"arn:iam::application/*"</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ› ï¸-ä½¿ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ğŸ› ï¸-ä½¿ç”¨ç¤ºä¾‹">#</a> ğŸ› ï¸ ä½¿ç”¨ç¤ºä¾‹</h2>
<h3 id="go-å®¢æˆ·ç«¯ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#go-å®¢æˆ·ç«¯ç¤ºä¾‹">#</a> Go å®¢æˆ·ç«¯ç¤ºä¾‹</h3>
<div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go"><pre v-pre><code class="language-go"><span class="line"><span class="token keyword">package</span> main</span>
<span class="line"></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">"context"</span></span>
<span class="line">    <span class="token string">"fmt"</span></span>
<span class="line">    <span class="token string">"log"</span></span>
<span class="line">    </span>
<span class="line">    <span class="token string">"google.golang.org/grpc"</span></span>
<span class="line">    <span class="token string">"google.golang.org/grpc/credentials/insecure"</span></span>
<span class="line">    <span class="token string">"google.golang.org/protobuf/types/known/fieldmaskpb"</span></span>
<span class="line">    </span>
<span class="line">    iamv1 <span class="token string">"github.com/your-org/vgo/api/iam/v1"</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// è¿æ¥åˆ°æœåŠ¡</span></span>
<span class="line">    conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> grpc<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">"localhost:50051"</span><span class="token punctuation">,</span> grpc<span class="token punctuation">.</span><span class="token function">WithTransportCredentials</span><span class="token punctuation">(</span>insecure<span class="token punctuation">.</span><span class="token function">NewCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"è¿æ¥å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">defer</span> conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    client <span class="token operator">:=</span> iamv1<span class="token punctuation">.</span><span class="token function">NewIAMClient</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span></span>
<span class="line">    ctx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 1. åˆ›å»ºåº”ç”¨</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"1. åˆ›å»ºåº”ç”¨..."</span><span class="token punctuation">)</span></span>
<span class="line">    createResp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">CreateApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>CreateApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Name<span class="token punctuation">:</span>        <span class="token string">"my-test-app"</span><span class="token punctuation">,</span></span>
<span class="line">        Description<span class="token punctuation">:</span> <span class="token string">"æµ‹è¯•åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">        HomepageUrl<span class="token punctuation">:</span> <span class="token string">"https://example.com"</span><span class="token punctuation">,</span></span>
<span class="line">        CallbackUrl<span class="token punctuation">:</span> <span class="token string">"https://example.com/callback"</span><span class="token punctuation">,</span></span>
<span class="line">        Type<span class="token punctuation">:</span>        iamv1<span class="token punctuation">.</span>ApplicationType_APPLICATION_TYPE_WEB<span class="token punctuation">,</span></span>
<span class="line">        Scopes<span class="token punctuation">:</span>      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"åˆ›å»ºåº”ç”¨å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    appID <span class="token operator">:=</span> createResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Id</span>
<span class="line">    clientID <span class="token operator">:=</span> createResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>ClientId</span>
<span class="line">    clientSecret <span class="token operator">:=</span> createResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>ClientSecret</span>
<span class="line">    </span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"åº”ç”¨åˆ›å»ºæˆåŠŸ:\n"</span><span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  åº”ç”¨ID: %s\n"</span><span class="token punctuation">,</span> appID<span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  å®¢æˆ·ç«¯ID: %s\n"</span><span class="token punctuation">,</span> clientID<span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  å®¢æˆ·ç«¯å¯†é’¥: %s\n"</span><span class="token punctuation">,</span> clientSecret<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 2. è·å–åº”ç”¨è¯¦æƒ…</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"\n2. è·å–åº”ç”¨è¯¦æƒ…..."</span><span class="token punctuation">)</span></span>
<span class="line">    getResp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">GetApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>GetApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Id<span class="token punctuation">:</span> appID<span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"è·å–åº”ç”¨å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"åº”ç”¨è¯¦æƒ…:\n"</span><span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  åç§°: %s\n"</span><span class="token punctuation">,</span> getResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Name<span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  æè¿°: %s\n"</span><span class="token punctuation">,</span> getResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Description<span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  ç±»å‹: %s\n"</span><span class="token punctuation">,</span> getResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Type<span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  çŠ¶æ€: %s\n"</span><span class="token punctuation">,</span> getResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Status<span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  æƒé™èŒƒå›´: %v\n"</span><span class="token punctuation">,</span> getResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Scopes<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 3. æ›´æ–°åº”ç”¨</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"\n3. æ›´æ–°åº”ç”¨..."</span><span class="token punctuation">)</span></span>
<span class="line">    updateResp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">UpdateApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>UpdateApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Id<span class="token punctuation">:</span>          appID<span class="token punctuation">,</span></span>
<span class="line">        Description<span class="token punctuation">:</span> <span class="token string">"æ›´æ–°åçš„æµ‹è¯•åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">        Scopes<span class="token punctuation">:</span>      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        UpdateMask<span class="token punctuation">:</span> <span class="token operator">&amp;</span>fieldmaskpb<span class="token punctuation">.</span>FieldMask<span class="token punctuation">{</span></span>
<span class="line">            Paths<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"description"</span><span class="token punctuation">,</span> <span class="token string">"scopes"</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"æ›´æ–°åº”ç”¨å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"åº”ç”¨æ›´æ–°æˆåŠŸ:\n"</span><span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  æ–°æè¿°: %s\n"</span><span class="token punctuation">,</span> updateResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Description<span class="token punctuation">)</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  æ–°æƒé™èŒƒå›´: %v\n"</span><span class="token punctuation">,</span> updateResp<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Scopes<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 4. åˆ—å‡ºåº”ç”¨</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"\n4. åˆ—å‡ºåº”ç”¨..."</span><span class="token punctuation">)</span></span>
<span class="line">    listResp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">ListApplications</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>ListApplicationsRequest<span class="token punctuation">{</span></span>
<span class="line">        Page<span class="token punctuation">:</span>     <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">        PageSize<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">        SortBy<span class="token punctuation">:</span>   <span class="token string">"created_at"</span><span class="token punctuation">,</span></span>
<span class="line">        SortDesc<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"åˆ—å‡ºåº”ç”¨å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"æ‰¾åˆ° %d ä¸ªåº”ç”¨:\n"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>listResp<span class="token punctuation">.</span>Applications<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i<span class="token punctuation">,</span> app <span class="token operator">:=</span> <span class="token keyword">range</span> listResp<span class="token punctuation">.</span>Applications <span class="token punctuation">{</span></span>
<span class="line">        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"  %d. %s (%s) - %s\n"</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> app<span class="token punctuation">.</span>Type<span class="token punctuation">,</span> app<span class="token punctuation">.</span>Status<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 5. åˆ é™¤åº”ç”¨</span></span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"\n5. åˆ é™¤åº”ç”¨..."</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">DeleteApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>DeleteApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Id<span class="token punctuation">:</span> appID<span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤åº”ç”¨å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"åº”ç”¨åˆ é™¤æˆåŠŸ"</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="python-å®¢æˆ·ç«¯ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#python-å®¢æˆ·ç«¯ç¤ºä¾‹">#</a> Python å®¢æˆ·ç«¯ç¤ºä¾‹</h3>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre v-pre><code class="language-python"><span class="line"><span class="token keyword">import</span> grpc</span>
<span class="line"><span class="token keyword">from</span> google<span class="token punctuation">.</span>protobuf <span class="token keyword">import</span> field_mask_pb2</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å‡è®¾å·²ç”Ÿæˆçš„Python gRPCå®¢æˆ·ç«¯</span></span>
<span class="line"><span class="token keyword">from</span> iam<span class="token punctuation">.</span>v1 <span class="token keyword">import</span> iam_pb2<span class="token punctuation">,</span> iam_pb2_grpc</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># è¿æ¥åˆ°æœåŠ¡</span></span>
<span class="line">    <span class="token keyword">with</span> grpc<span class="token punctuation">.</span>insecure_channel<span class="token punctuation">(</span><span class="token string">'localhost:50051'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> channel<span class="token punctuation">:</span></span>
<span class="line">        client <span class="token operator">=</span> iam_pb2_grpc<span class="token punctuation">.</span>IAMStub<span class="token punctuation">(</span>channel<span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment"># 1. åˆ›å»ºåº”ç”¨</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1. åˆ›å»ºåº”ç”¨..."</span><span class="token punctuation">)</span></span>
<span class="line">        create_request <span class="token operator">=</span> iam_pb2<span class="token punctuation">.</span>CreateApplicationRequest<span class="token punctuation">(</span></span>
<span class="line">            name<span class="token operator">=</span><span class="token string">"my-python-app"</span><span class="token punctuation">,</span></span>
<span class="line">            description<span class="token operator">=</span><span class="token string">"Pythonæµ‹è¯•åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">            homepage_url<span class="token operator">=</span><span class="token string">"https://python-app.com"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token builtin">type</span><span class="token operator">=</span>iam_pb2<span class="token punctuation">.</span>APPLICATION_TYPE_DESKTOP<span class="token punctuation">,</span></span>
<span class="line">            scopes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        create_response <span class="token operator">=</span> client<span class="token punctuation">.</span>CreateApplication<span class="token punctuation">(</span>create_request<span class="token punctuation">)</span></span>
<span class="line">        app_id <span class="token operator">=</span> create_response<span class="token punctuation">.</span>application<span class="token punctuation">.</span><span class="token builtin">id</span></span>
<span class="line">        client_id <span class="token operator">=</span> create_response<span class="token punctuation">.</span>application<span class="token punctuation">.</span>client_id</span>
<span class="line">        client_secret <span class="token operator">=</span> create_response<span class="token punctuation">.</span>application<span class="token punctuation">.</span>client_secret</span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"åº”ç”¨åˆ›å»ºæˆåŠŸ:"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  åº”ç”¨ID: </span><span class="token interpolation"><span class="token punctuation">{</span>app_id<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  å®¢æˆ·ç«¯ID: </span><span class="token interpolation"><span class="token punctuation">{</span>client_id<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  å®¢æˆ·ç«¯å¯†é’¥: </span><span class="token interpolation"><span class="token punctuation">{</span>client_secret<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment"># 2. è·å–åº”ç”¨è¯¦æƒ…</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n2. è·å–åº”ç”¨è¯¦æƒ…..."</span><span class="token punctuation">)</span></span>
<span class="line">        get_request <span class="token operator">=</span> iam_pb2<span class="token punctuation">.</span>GetApplicationRequest<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>app_id<span class="token punctuation">)</span></span>
<span class="line">        get_response <span class="token operator">=</span> client<span class="token punctuation">.</span>GetApplication<span class="token punctuation">(</span>get_request<span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        app <span class="token operator">=</span> get_response<span class="token punctuation">.</span>application</span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"åº”ç”¨è¯¦æƒ…:"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  åç§°: </span><span class="token interpolation"><span class="token punctuation">{</span>app<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  æè¿°: </span><span class="token interpolation"><span class="token punctuation">{</span>app<span class="token punctuation">.</span>description<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  ç±»å‹: </span><span class="token interpolation"><span class="token punctuation">{</span>app<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  çŠ¶æ€: </span><span class="token interpolation"><span class="token punctuation">{</span>app<span class="token punctuation">.</span>status<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  æƒé™èŒƒå›´: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">list</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>scopes<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment"># 3. æ›´æ–°åº”ç”¨</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n3. æ›´æ–°åº”ç”¨..."</span><span class="token punctuation">)</span></span>
<span class="line">        update_mask <span class="token operator">=</span> field_mask_pb2<span class="token punctuation">.</span>FieldMask<span class="token punctuation">(</span>paths<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"description"</span><span class="token punctuation">,</span> <span class="token string">"status"</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        update_request <span class="token operator">=</span> iam_pb2<span class="token punctuation">.</span>UpdateApplicationRequest<span class="token punctuation">(</span></span>
<span class="line">            <span class="token builtin">id</span><span class="token operator">=</span>app_id<span class="token punctuation">,</span></span>
<span class="line">            description<span class="token operator">=</span><span class="token string">"æ›´æ–°åçš„Pythonåº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">            status<span class="token operator">=</span>iam_pb2<span class="token punctuation">.</span>APPLICATION_STATUS_INACTIVE<span class="token punctuation">,</span></span>
<span class="line">            update_mask<span class="token operator">=</span>update_mask</span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        update_response <span class="token operator">=</span> client<span class="token punctuation">.</span>UpdateApplication<span class="token punctuation">(</span>update_request<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"åº”ç”¨æ›´æ–°æˆåŠŸ:"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  æ–°æè¿°: </span><span class="token interpolation"><span class="token punctuation">{</span>update_response<span class="token punctuation">.</span>application<span class="token punctuation">.</span>description<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  æ–°çŠ¶æ€: </span><span class="token interpolation"><span class="token punctuation">{</span>update_response<span class="token punctuation">.</span>application<span class="token punctuation">.</span>status<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment"># 4. åˆ—å‡ºåº”ç”¨</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n4. åˆ—å‡ºåº”ç”¨..."</span><span class="token punctuation">)</span></span>
<span class="line">        list_request <span class="token operator">=</span> iam_pb2<span class="token punctuation">.</span>ListApplicationsRequest<span class="token punctuation">(</span></span>
<span class="line">            <span class="token builtin">type</span><span class="token operator">=</span>iam_pb2<span class="token punctuation">.</span>APPLICATION_TYPE_DESKTOP<span class="token punctuation">,</span></span>
<span class="line">            page<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">            page_size<span class="token operator">=</span><span class="token number">10</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        list_response <span class="token operator">=</span> client<span class="token punctuation">.</span>ListApplications<span class="token punctuation">(</span>list_request<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ° </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>list_response<span class="token punctuation">.</span>applications<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> ä¸ªæ¡Œé¢åº”ç”¨:"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> i<span class="token punctuation">,</span> app <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>list_response<span class="token punctuation">.</span>applications<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">. </span><span class="token interpolation"><span class="token punctuation">{</span>app<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span>app<span class="token punctuation">.</span>status<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment"># 5. åˆ é™¤åº”ç”¨</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n5. åˆ é™¤åº”ç”¨..."</span><span class="token punctuation">)</span></span>
<span class="line">        delete_request <span class="token operator">=</span> iam_pb2<span class="token punctuation">.</span>DeleteApplicationRequest<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>app_id<span class="token punctuation">)</span></span>
<span class="line">        client<span class="token punctuation">.</span>DeleteApplication<span class="token punctuation">(</span>delete_request<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åº”ç”¨åˆ é™¤æˆåŠŸ"</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span></span>
<span class="line">    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ‰¹é‡åº”ç”¨ç®¡ç†è„šæœ¬" tabindex="-1"><a class="header-anchor" href="#æ‰¹é‡åº”ç”¨ç®¡ç†è„šæœ¬">#</a> æ‰¹é‡åº”ç”¨ç®¡ç†è„šæœ¬</h3>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token shebang important">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ‰¹é‡åº”ç”¨ç®¡ç†è„šæœ¬</span></span>
<span class="line"><span class="token assign-left variable">SERVER</span><span class="token operator">=</span><span class="token string">"localhost:50051"</span></span>
<span class="line"><span class="token assign-left variable">APPS_CONFIG</span><span class="token operator">=</span><span class="token string">"apps_config.json"</span></span>
<span class="line"><span class="token assign-left variable">OUTPUT_FILE</span><span class="token operator">=</span><span class="token string">"applications_report.csv"</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºCSVå¤´éƒ¨</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">"åº”ç”¨åç§°,åº”ç”¨ID,å®¢æˆ·ç«¯ID,å®¢æˆ·ç«¯å¯†é’¥,ç±»å‹,çŠ¶æ€,åˆ›å»ºæ—¶é—´"</span> <span class="token operator">></span> <span class="token string">"<span class="token variable">$OUTPUT_FILE</span>"</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä»é…ç½®æ–‡ä»¶è¯»å–åº”ç”¨é…ç½®å¹¶æ‰¹é‡åˆ›å»º</span></span>
<span class="line">jq <span class="token parameter variable">-c</span> <span class="token string">'.applications[]'</span> <span class="token string">"<span class="token variable">$APPS_CONFIG</span>"</span> <span class="token operator">|</span> <span class="token keyword">while</span> <span class="token builtin class-name">read</span> app_config<span class="token punctuation">;</span> <span class="token keyword">do</span></span>
<span class="line">    <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_config</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.name'</span><span class="token variable">)</span></span></span>
<span class="line">    <span class="token assign-left variable">description</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_config</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.description'</span><span class="token variable">)</span></span></span>
<span class="line">    <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_config</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.type'</span><span class="token variable">)</span></span></span>
<span class="line">    <span class="token assign-left variable">scopes</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_config</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.scopes | join(",")'</span><span class="token variable">)</span></span></span>
<span class="line">    </span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">"åˆ›å»ºåº”ç”¨: <span class="token variable">$name</span>"</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ„é€ åˆ›å»ºè¯·æ±‚</span></span>
<span class="line">    <span class="token assign-left variable">create_request</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_config</span>"</span> <span class="token operator">|</span> jq <span class="token string">'{</span>
<span class="line">        name: .name,</span>
<span class="line">        description: .description,</span>
<span class="line">        homepage_url: .homepage_url,</span>
<span class="line">        callback_url: .callback_url,</span>
<span class="line">        type: .type,</span>
<span class="line">        scopes: .scopes</span>
<span class="line">    }'</span><span class="token variable">)</span></span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># åˆ›å»ºåº”ç”¨</span></span>
<span class="line">    <span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">"<span class="token variable">$create_request</span>"</span> <span class="token string">"<span class="token variable">$SERVER</span>"</span> iam.v1.IAM/CreateApplication <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null<span class="token variable">)</span></span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">        <span class="token comment"># è§£æç»“æœ</span></span>
<span class="line">        <span class="token assign-left variable">app_id</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$result</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.id'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">client_id</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$result</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.client_id'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">client_secret</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$result</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.client_secret'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">app_type</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$result</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.type'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">status</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$result</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.status'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">created_at</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$result</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.created_at'</span><span class="token variable">)</span></span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment"># å†™å…¥CSVæ–‡ä»¶</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$name</span>,<span class="token variable">$app_id</span>,<span class="token variable">$client_id</span>,<span class="token variable">$client_secret</span>,<span class="token variable">$app_type</span>,<span class="token variable">$status</span>,<span class="token variable">$created_at</span>"</span> <span class="token operator">>></span> <span class="token string">"<span class="token variable">$OUTPUT_FILE</span>"</span></span>
<span class="line">        </span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"  æˆåŠŸ: <span class="token variable">$app_id</span>"</span></span>
<span class="line">    <span class="token keyword">else</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"  å¤±è´¥: æ— æ³•åˆ›å»ºåº”ç”¨ <span class="token variable">$name</span>"</span></span>
<span class="line">    <span class="token keyword">fi</span></span>
<span class="line">    </span>
<span class="line">    <span class="token function">sleep</span> <span class="token number">0.1</span>  <span class="token comment"># é¿å…è¿‡å¿«è¯·æ±‚</span></span>
<span class="line"><span class="token keyword">done</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">"æ‰¹é‡åˆ›å»ºå®Œæˆï¼Œç»“æœä¿å­˜åœ¨ <span class="token variable">$OUTPUT_FILE</span>"</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®æ–‡ä»¶ç¤ºä¾‹ (<code v-pre>apps_config.json</code>)ï¼š</p>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre v-pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"applications"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"web-frontend"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Webå‰ç«¯åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"homepage_url"</span><span class="token operator">:</span> <span class="token string">"https://web.example.com"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"callback_url"</span><span class="token operator">:</span> <span class="token string">"https://web.example.com/callback"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_TYPE_WEB"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"mobile-app"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"ç§»åŠ¨åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_TYPE_MOBILE"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"offline_access"</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"api-service"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"APIæœåŠ¡"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"APPLICATION_TYPE_SERVICE"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"admin"</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ”-æœ€ä½³å®è·µ" tabindex="-1"><a class="header-anchor" href="#ğŸ”-æœ€ä½³å®è·µ">#</a> ğŸ” æœ€ä½³å®è·µ</h2>
<h3 id="_1-åº”ç”¨è®¾è®¡åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#_1-åº”ç”¨è®¾è®¡åŸåˆ™">#</a> 1. åº”ç”¨è®¾è®¡åŸåˆ™</h3>
<h4 id="å•ä¸€èŒè´£" tabindex="-1"><a class="header-anchor" href="#å•ä¸€èŒè´£">#</a> å•ä¸€èŒè´£</h4>
<div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go"><pre v-pre><code class="language-go"><span class="line"><span class="token comment">// ä¸ºä¸åŒç”¨é€”åˆ›å»ºä¸åŒçš„åº”ç”¨</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token function">createApplications</span><span class="token punctuation">(</span>client iamv1<span class="token punctuation">.</span>IAMClient<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span></span>
<span class="line">    ctx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// Webå‰ç«¯åº”ç”¨</span></span>
<span class="line">    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">CreateApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>CreateApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Name<span class="token punctuation">:</span>        <span class="token string">"web-frontend"</span><span class="token punctuation">,</span></span>
<span class="line">        Description<span class="token punctuation">:</span> <span class="token string">"Webå‰ç«¯åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">        Type<span class="token punctuation">:</span>        iamv1<span class="token punctuation">.</span>ApplicationType_APPLICATION_TYPE_WEB<span class="token punctuation">,</span></span>
<span class="line">        Scopes<span class="token punctuation">:</span>      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> err</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// ç§»åŠ¨åº”ç”¨</span></span>
<span class="line">    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">CreateApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>CreateApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Name<span class="token punctuation">:</span>        <span class="token string">"mobile-app"</span><span class="token punctuation">,</span></span>
<span class="line">        Description<span class="token punctuation">:</span> <span class="token string">"ç§»åŠ¨åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">        Type<span class="token punctuation">:</span>        iamv1<span class="token punctuation">.</span>ApplicationType_APPLICATION_TYPE_MOBILE<span class="token punctuation">,</span></span>
<span class="line">        Scopes<span class="token punctuation">:</span>      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"offline_access"</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> err</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// åå°æœåŠ¡</span></span>
<span class="line">    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">CreateApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>CreateApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Name<span class="token punctuation">:</span>        <span class="token string">"backend-service"</span><span class="token punctuation">,</span></span>
<span class="line">        Description<span class="token punctuation">:</span> <span class="token string">"åå°æœåŠ¡åº”ç”¨"</span><span class="token punctuation">,</span></span>
<span class="line">        Type<span class="token punctuation">:</span>        iamv1<span class="token punctuation">.</span>ApplicationType_APPLICATION_TYPE_SERVICE<span class="token punctuation">,</span></span>
<span class="line">        Scopes<span class="token punctuation">:</span>      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> err</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æƒé™æœ€å°åŒ–" tabindex="-1"><a class="header-anchor" href="#æƒé™æœ€å°åŒ–">#</a> æƒé™æœ€å°åŒ–</h4>
<div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go"><pre v-pre><code class="language-go"><span class="line"><span class="token comment">// æ ¹æ®åº”ç”¨ç±»å‹è®¾ç½®åˆé€‚çš„æƒé™èŒƒå›´</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token function">getScopesForApplicationType</span><span class="token punctuation">(</span>appType iamv1<span class="token punctuation">.</span>ApplicationType<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">switch</span> appType <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">case</span> iamv1<span class="token punctuation">.</span>ApplicationType_APPLICATION_TYPE_WEB<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">case</span> iamv1<span class="token punctuation">.</span>ApplicationType_APPLICATION_TYPE_MOBILE<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"offline_access"</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">case</span> iamv1<span class="token punctuation">.</span>ApplicationType_APPLICATION_TYPE_SERVICE<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"admin"</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">case</span> iamv1<span class="token punctuation">.</span>ApplicationType_APPLICATION_TYPE_SPA<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">}</span> <span class="token comment">// å•é¡µåº”ç”¨é€šå¸¸åªéœ€è¦è¯»æƒé™</span></span>
<span class="line">    <span class="token keyword">default</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"read"</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-å®¢æˆ·ç«¯å¯†é’¥ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_2-å®¢æˆ·ç«¯å¯†é’¥ç®¡ç†">#</a> 2. å®¢æˆ·ç«¯å¯†é’¥ç®¡ç†</h3>
<h4 id="å®‰å…¨å­˜å‚¨" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨å­˜å‚¨">#</a> å®‰å…¨å­˜å‚¨</h4>
<div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go"><pre v-pre><code class="language-go"><span class="line"><span class="token comment">// å®‰å…¨å­˜å‚¨å®¢æˆ·ç«¯å¯†é’¥</span></span>
<span class="line"><span class="token keyword">type</span> ApplicationCredentials <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>
<span class="line">    ClientID     <span class="token builtin">string</span> <span class="token string">`json:"client_id"`</span></span>
<span class="line">    ClientSecret <span class="token builtin">string</span> <span class="token string">`json:"-"`</span> <span class="token comment">// ä¸åºåˆ—åŒ–åˆ°JSON</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token punctuation">(</span>ac <span class="token operator">*</span>ApplicationCredentials<span class="token punctuation">)</span> <span class="token function">StoreSecurely</span><span class="token punctuation">(</span>keyring <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// ä½¿ç”¨ç³»ç»Ÿå¯†é’¥ç¯å­˜å‚¨å®¢æˆ·ç«¯å¯†é’¥</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">storeInKeyring</span><span class="token punctuation">(</span>keyring<span class="token punctuation">,</span> ac<span class="token punctuation">.</span>ClientID<span class="token punctuation">,</span> ac<span class="token punctuation">.</span>ClientSecret<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token punctuation">(</span>ac <span class="token operator">*</span>ApplicationCredentials<span class="token punctuation">)</span> <span class="token function">LoadSecurely</span><span class="token punctuation">(</span>keyring <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// ä»ç³»ç»Ÿå¯†é’¥ç¯åŠ è½½å®¢æˆ·ç«¯å¯†é’¥</span></span>
<span class="line">    secret<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">loadFromKeyring</span><span class="token punctuation">(</span>keyring<span class="token punctuation">,</span> ac<span class="token punctuation">.</span>ClientID<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> err</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    ac<span class="token punctuation">.</span>ClientSecret <span class="token operator">=</span> secret</span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">nil</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å¯†é’¥è½®æ¢" tabindex="-1"><a class="header-anchor" href="#å¯†é’¥è½®æ¢">#</a> å¯†é’¥è½®æ¢</h4>
<div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go"><pre v-pre><code class="language-go"><span class="line"><span class="token comment">// å®¢æˆ·ç«¯å¯†é’¥è½®æ¢ï¼ˆéœ€è¦é‡æ–°åˆ›å»ºåº”ç”¨ï¼‰</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token function">rotateApplicationCredentials</span><span class="token punctuation">(</span>client iamv1<span class="token punctuation">.</span>IAMClient<span class="token punctuation">,</span> appID <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>iamv1<span class="token punctuation">.</span>Application<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    ctx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 1. è·å–å½“å‰åº”ç”¨ä¿¡æ¯</span></span>
<span class="line">    getResp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">GetApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>GetApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Id<span class="token punctuation">:</span> appID<span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"è·å–åº”ç”¨ä¿¡æ¯å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    oldApp <span class="token operator">:=</span> getResp<span class="token punctuation">.</span>Application</span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 2. åˆ›å»ºæ–°åº”ç”¨ï¼ˆç›¸åŒé…ç½®ï¼‰</span></span>
<span class="line">    newApp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">CreateApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>CreateApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Name<span class="token punctuation">:</span>        oldApp<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"-new"</span><span class="token punctuation">,</span></span>
<span class="line">        Description<span class="token punctuation">:</span> oldApp<span class="token punctuation">.</span>Description <span class="token operator">+</span> <span class="token string">" (è½®æ¢å)"</span><span class="token punctuation">,</span></span>
<span class="line">        HomepageUrl<span class="token punctuation">:</span> oldApp<span class="token punctuation">.</span>HomepageUrl<span class="token punctuation">,</span></span>
<span class="line">        CallbackUrl<span class="token punctuation">:</span> oldApp<span class="token punctuation">.</span>CallbackUrl<span class="token punctuation">,</span></span>
<span class="line">        Type<span class="token punctuation">:</span>        oldApp<span class="token punctuation">.</span>Type<span class="token punctuation">,</span></span>
<span class="line">        Scopes<span class="token punctuation">:</span>      oldApp<span class="token punctuation">.</span>Scopes<span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"åˆ›å»ºæ–°åº”ç”¨å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 3. æ›´æ–°åº”ç”¨é…ç½®ï¼ˆè¿™é‡Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µå®ç°ï¼‰</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">updateApplicationConfig</span><span class="token punctuation">(</span>newApp<span class="token punctuation">.</span>Application<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"æ›´æ–°åº”ç”¨é…ç½®å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 4. ç­‰å¾…é…ç½®ç”Ÿæ•ˆ</span></span>
<span class="line">    time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">30</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 5. åˆ é™¤æ—§åº”ç”¨</span></span>
<span class="line">    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">DeleteApplication</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>DeleteApplicationRequest<span class="token punctuation">{</span></span>
<span class="line">        Id<span class="token punctuation">:</span>    appID<span class="token punctuation">,</span></span>
<span class="line">        Force<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤æ—§åº”ç”¨å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">return</span> newApp<span class="token punctuation">.</span>Application<span class="token punctuation">,</span> <span class="token boolean">nil</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-åº”ç”¨ç›‘æ§å’Œå®¡è®¡" tabindex="-1"><a class="header-anchor" href="#_3-åº”ç”¨ç›‘æ§å’Œå®¡è®¡">#</a> 3. åº”ç”¨ç›‘æ§å’Œå®¡è®¡</h3>
<div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go"><pre v-pre><code class="language-go"><span class="line"><span class="token comment">// åº”ç”¨ä½¿ç”¨æƒ…å†µç›‘æ§</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token function">monitorApplicationUsage</span><span class="token punctuation">(</span>client iamv1<span class="token punctuation">.</span>IAMClient<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    ctx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    apps<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">ListApplications</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>iamv1<span class="token punctuation">.</span>ListApplicationsRequest<span class="token punctuation">{</span></span>
<span class="line">        Page<span class="token punctuation">:</span>     <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">        PageSize<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"è·å–åº”ç”¨åˆ—è¡¨å¤±è´¥: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> app <span class="token operator">:=</span> <span class="token keyword">range</span> apps<span class="token punctuation">.</span>Applications <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// æ£€æŸ¥æœ€åä½¿ç”¨æ—¶é—´</span></span>
<span class="line">        <span class="token keyword">if</span> app<span class="token punctuation">.</span>LastUsedAt <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">            lastUsed <span class="token operator">:=</span> app<span class="token punctuation">.</span>LastUsedAt<span class="token punctuation">.</span><span class="token function">AsTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">if</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>lastUsed<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">30</span><span class="token operator">*</span><span class="token number">24</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Hour <span class="token punctuation">{</span> <span class="token comment">// 30å¤©æœªä½¿ç”¨</span></span>
<span class="line">                log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"è­¦å‘Š: åº”ç”¨ %s å·²è¶…è¿‡30å¤©æœªä½¿ç”¨"</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>Name<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">// æ£€æŸ¥ç”¨æˆ·æ•°é‡</span></span>
<span class="line">        <span class="token keyword">if</span> app<span class="token punctuation">.</span>UserCount <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span></span>
<span class="line">            log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"è­¦å‘Š: åº”ç”¨ %s æ²¡æœ‰å…³è”ç”¨æˆ·"</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>Name<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">// æ£€æŸ¥è®¿é—®å¯†é’¥æ•°é‡</span></span>
<span class="line">        <span class="token keyword">if</span> app<span class="token punctuation">.</span>AccessKeyCount <span class="token operator">></span> <span class="token number">10</span> <span class="token punctuation">{</span></span>
<span class="line">            log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"è­¦å‘Š: åº”ç”¨ %s çš„è®¿é—®å¯†é’¥æ•°é‡è¿‡å¤š (%d)"</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> app<span class="token punctuation">.</span>AccessKeyCount<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_4-åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†">#</a> 4. åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre v-pre><code class="language-bash"><span class="line"><span class="token shebang important">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†è„šæœ¬</span></span>
<span class="line"><span class="token assign-left variable">SERVER</span><span class="token operator">=</span><span class="token string">"localhost:50051"</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åº”ç”¨å¥åº·æ£€æŸ¥</span></span>
<span class="line"><span class="token function-name function">check_application_health</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin class-name">local</span> <span class="token assign-left variable">app_id</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span></span>
<span class="line">    </span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">"æ£€æŸ¥åº”ç”¨å¥åº·çŠ¶æ€: <span class="token variable">$app_id</span>"</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è·å–åº”ç”¨è¯¦æƒ…</span></span>
<span class="line">    <span class="token assign-left variable">app_info</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">"{</span>
<span class="line">        <span class="token entity" title="\&quot;">\"</span>id<span class="token entity" title="\&quot;">\"</span>: <span class="token entity" title="\&quot;">\"</span><span class="token variable">$app_id</span><span class="token entity" title="\&quot;">\"</span></span>
<span class="line">    }"</span> <span class="token string">"<span class="token variable">$SERVER</span>"</span> iam.v1.IAM/GetApplication<span class="token variable">)</span></span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-ne</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"é”™è¯¯: æ— æ³•è·å–åº”ç”¨ä¿¡æ¯"</span></span>
<span class="line">        <span class="token builtin class-name">return</span> <span class="token number">1</span></span>
<span class="line">    <span class="token keyword">fi</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ£€æŸ¥åº”ç”¨çŠ¶æ€</span></span>
<span class="line">    <span class="token assign-left variable">status</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_info</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.status'</span><span class="token variable">)</span></span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$status</span>"</span> <span class="token operator">!=</span> <span class="token string">"APPLICATION_STATUS_ACTIVE"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"è­¦å‘Š: åº”ç”¨çŠ¶æ€å¼‚å¸¸ - <span class="token variable">$status</span>"</span></span>
<span class="line">    <span class="token keyword">fi</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ£€æŸ¥æœ€åä½¿ç”¨æ—¶é—´</span></span>
<span class="line">    <span class="token assign-left variable">last_used</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_info</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.last_used_at'</span><span class="token variable">)</span></span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$last_used</span>"</span> <span class="token operator">!=</span> <span class="token string">"null"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">        <span class="token comment"># è®¡ç®—å¤©æ•°å·®å¼‚ï¼ˆç®€åŒ–è®¡ç®—ï¼‰</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"æœ€åä½¿ç”¨æ—¶é—´: <span class="token variable">$last_used</span>"</span></span>
<span class="line">    <span class="token keyword">else</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"è­¦å‘Š: åº”ç”¨ä»æœªè¢«ä½¿ç”¨"</span></span>
<span class="line">    <span class="token keyword">fi</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ£€æŸ¥å…³è”èµ„æº</span></span>
<span class="line">    <span class="token assign-left variable">user_count</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_info</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.user_count'</span><span class="token variable">)</span></span></span>
<span class="line">    <span class="token assign-left variable">access_key_count</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app_info</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.application.access_key_count'</span><span class="token variable">)</span></span></span>
<span class="line">    </span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">"å…³è”ç”¨æˆ·æ•°: <span class="token variable">$user_count</span>"</span></span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">"è®¿é—®å¯†é’¥æ•°: <span class="token variable">$access_key_count</span>"</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$user_count</span>"</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$access_key_count</span>"</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"è­¦å‘Š: åº”ç”¨æ²¡æœ‰å…³è”ä»»ä½•èµ„æºï¼Œå¯èƒ½éœ€è¦æ¸…ç†"</span></span>
<span class="line">    <span class="token keyword">fi</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ¸…ç†æœªä½¿ç”¨çš„åº”ç”¨</span></span>
<span class="line"><span class="token function-name function">cleanup_unused_applications</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">"å¼€å§‹æ¸…ç†æœªä½¿ç”¨çš„åº”ç”¨..."</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è·å–æ‰€æœ‰åº”ç”¨</span></span>
<span class="line">    <span class="token assign-left variable">apps</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">        "page": 1,</span>
<span class="line">        "page_size": 1000</span>
<span class="line">    }'</span> <span class="token string">"<span class="token variable">$SERVER</span>"</span> iam.v1.IAM/ListApplications<span class="token variable">)</span></span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># æ£€æŸ¥æ¯ä¸ªåº”ç”¨</span></span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$apps</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-c</span> <span class="token string">'.applications[]'</span> <span class="token operator">|</span> <span class="token keyword">while</span> <span class="token builtin class-name">read</span> app<span class="token punctuation">;</span> <span class="token keyword">do</span></span>
<span class="line">        <span class="token assign-left variable">app_id</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.id'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">app_name</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.name'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">user_count</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.user_count'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">access_key_count</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.access_key_count'</span><span class="token variable">)</span></span></span>
<span class="line">        <span class="token assign-left variable">last_used</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$app</span>"</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'.last_used_at'</span><span class="token variable">)</span></span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment"># å¦‚æœåº”ç”¨æ²¡æœ‰å…³è”èµ„æºä¸”ä»æœªä½¿ç”¨ï¼Œæ ‡è®°ä¸ºå¯åˆ é™¤</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$user_count</span>"</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$access_key_count</span>"</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$last_used</span>"</span> <span class="token operator">=</span> <span class="token string">"null"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">            <span class="token builtin class-name">echo</span> <span class="token string">"å‘ç°æœªä½¿ç”¨çš„åº”ç”¨: <span class="token variable">$app_name</span> (<span class="token variable">$app_id</span>)"</span></span>
<span class="line">            <span class="token builtin class-name">echo</span> <span class="token string">"æ˜¯å¦åˆ é™¤æ­¤åº”ç”¨? (y/N)"</span></span>
<span class="line">            <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> confirm</span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$confirm</span>"</span> <span class="token operator">=</span> <span class="token string">"y"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$confirm</span>"</span> <span class="token operator">=</span> <span class="token string">"Y"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">                grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">"{</span>
<span class="line">                    <span class="token entity" title="\&quot;">\"</span>id<span class="token entity" title="\&quot;">\"</span>: <span class="token entity" title="\&quot;">\"</span><span class="token variable">$app_id</span><span class="token entity" title="\&quot;">\"</span></span>
<span class="line">                }"</span> <span class="token string">"<span class="token variable">$SERVER</span>"</span> iam.v1.IAM/DeleteApplication</span>
<span class="line">                <span class="token builtin class-name">echo</span> <span class="token string">"åº”ç”¨ <span class="token variable">$app_name</span> å·²åˆ é™¤"</span></span>
<span class="line">            <span class="token keyword">fi</span></span>
<span class="line">        <span class="token keyword">fi</span></span>
<span class="line">    <span class="token keyword">done</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åº”ç”¨å¤‡ä»½</span></span>
<span class="line"><span class="token function-name function">backup_applications</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token builtin class-name">local</span> <span class="token assign-left variable">backup_file</span><span class="token operator">=</span><span class="token string">"applications_backup_<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y%m%d_%H%M%S<span class="token variable">)</span></span>.json"</span></span>
<span class="line">    </span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">"å¤‡ä»½åº”ç”¨é…ç½®åˆ°: <span class="token variable">$backup_file</span>"</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># è·å–æ‰€æœ‰åº”ç”¨</span></span>
<span class="line">    grpcurl <span class="token parameter variable">-plaintext</span> <span class="token parameter variable">-d</span> <span class="token string">'{</span>
<span class="line">        "page": 1,</span>
<span class="line">        "page_size": 1000</span>
<span class="line">    }'</span> <span class="token string">"<span class="token variable">$SERVER</span>"</span> iam.v1.IAM/ListApplications <span class="token operator">></span> <span class="token string">"<span class="token variable">$backup_file</span>"</span></span>
<span class="line">    </span>
<span class="line">    <span class="token builtin class-name">echo</span> <span class="token string">"å¤‡ä»½å®Œæˆ"</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä¸»å‡½æ•°</span></span>
<span class="line"><span class="token keyword">case</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token keyword">in</span></span>
<span class="line">    <span class="token string">"health"</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$2</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></span>
<span class="line">            <span class="token builtin class-name">echo</span> <span class="token string">"ç”¨æ³•: <span class="token variable">$0</span> health &lt;åº”ç”¨ID>"</span></span>
<span class="line">            <span class="token builtin class-name">exit</span> <span class="token number">1</span></span>
<span class="line">        <span class="token keyword">fi</span></span>
<span class="line">        check_application_health <span class="token string">"<span class="token variable">$2</span>"</span></span>
<span class="line">        <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token string">"cleanup"</span><span class="token punctuation">)</span></span>
<span class="line">        cleanup_unused_applications</span>
<span class="line">        <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token string">"backup"</span><span class="token punctuation">)</span></span>
<span class="line">        backup_applications</span>
<span class="line">        <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">    *<span class="token punctuation">)</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"ç”¨æ³•: <span class="token variable">$0</span> {health|cleanup|backup} [åº”ç”¨ID]"</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"  health &lt;åº”ç”¨ID>  - æ£€æŸ¥åº”ç”¨å¥åº·çŠ¶æ€"</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"  cleanup          - æ¸…ç†æœªä½¿ç”¨çš„åº”ç”¨"</span></span>
<span class="line">        <span class="token builtin class-name">echo</span> <span class="token string">"  backup           - å¤‡ä»½åº”ç”¨é…ç½®"</span></span>
<span class="line">        <span class="token builtin class-name">exit</span> <span class="token number">1</span></span>
<span class="line">        <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">esac</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸš¨-æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#ğŸš¨-æ³¨æ„äº‹é¡¹">#</a> ğŸš¨ æ³¨æ„äº‹é¡¹</h2>
<h3 id="å®‰å…¨è€ƒè™‘" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨è€ƒè™‘">#</a> å®‰å…¨è€ƒè™‘</h3>
<ol>
<li>
<p><strong>å®¢æˆ·ç«¯å¯†é’¥ä¿æŠ¤</strong>ï¼š</p>
<ul>
<li>æ°¸è¿œä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å®¢æˆ·ç«¯å¯†é’¥</li>
<li>ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å®‰å…¨çš„é…ç½®ç®¡ç†ç³»ç»Ÿ</li>
<li>å®šæœŸè½®æ¢å®¢æˆ·ç«¯å¯†é’¥</li>
</ul>
</li>
<li>
<p><strong>æƒé™æ§åˆ¶</strong>ï¼š</p>
<ul>
<li>éµå¾ªæœ€å°æƒé™åŸåˆ™</li>
<li>ä¸ºä¸åŒç”¨é€”åˆ›å»ºä¸åŒçš„åº”ç”¨</li>
<li>å®šæœŸå®¡æŸ¥åº”ç”¨æƒé™</li>
</ul>
</li>
<li>
<p><strong>è®¿é—®æ§åˆ¶</strong>ï¼š</p>
<ul>
<li>é™åˆ¶åº”ç”¨åˆ›å»ºæƒé™</li>
<li>ç›‘æ§åº”ç”¨ä½¿ç”¨æƒ…å†µ</li>
<li>åŠæ—¶åˆ é™¤ä¸ä½¿ç”¨çš„åº”ç”¨</li>
</ul>
</li>
</ol>
<h3 id="æ€§èƒ½ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ€§èƒ½ä¼˜åŒ–">#</a> æ€§èƒ½ä¼˜åŒ–</h3>
<ol>
<li>
<p><strong>æ‰¹é‡æ“ä½œ</strong>ï¼š</p>
<ul>
<li>é¿å…å¾ªç¯è°ƒç”¨API</li>
<li>ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢å¤§é‡æ•°æ®</li>
<li>åˆç†æ§åˆ¶å¹¶å‘æ•°</li>
</ul>
</li>
<li>
<p><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>ç¼“å­˜åº”ç”¨åŸºæœ¬ä¿¡æ¯</li>
<li>è®¾ç½®åˆé€‚çš„ç¼“å­˜è¿‡æœŸæ—¶é—´</li>
<li>ç›‘æ§ç¼“å­˜å‘½ä¸­ç‡</li>
</ul>
</li>
</ol>
<h3 id="è¿ç»´ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#è¿ç»´ç®¡ç†">#</a> è¿ç»´ç®¡ç†</h3>
<ol>
<li>
<p><strong>ç›‘æ§å‘Šè­¦</strong>ï¼š</p>
<ul>
<li>ç›‘æ§åº”ç”¨åˆ›å»ºå’Œåˆ é™¤æ“ä½œ</li>
<li>è®¾ç½®åº”ç”¨æ•°é‡å‘Šè­¦</li>
<li>ç›‘æ§å¼‚å¸¸ä½¿ç”¨æ¨¡å¼</li>
</ul>
</li>
<li>
<p><strong>å¤‡ä»½æ¢å¤</strong>ï¼š</p>
<ul>
<li>å®šæœŸå¤‡ä»½åº”ç”¨é…ç½®</li>
<li>æµ‹è¯•æ¢å¤æµç¨‹</li>
<li>ä¿ç•™å†å²å¤‡ä»½</li>
</ul>
</li>
</ol>
<hr>
<div class="hint-container tip">
<p class="hint-container-title">æç¤º</p>
<p>å»ºè®®ä¸ºæ¯ä¸ªç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰åˆ›å»ºç‹¬ç«‹çš„åº”ç”¨ï¼Œä¾¿äºç®¡ç†å’Œéš”ç¦»ã€‚</p>
</div>
<div class="hint-container warning">
<p class="hint-container-title">æ³¨æ„</p>
<p>åº”ç”¨çš„å®¢æˆ·ç«¯å¯†é’¥åªåœ¨åˆ›å»ºæ—¶è¿”å›ä¸€æ¬¡ï¼Œè¯·åŠ¡å¿…å¦¥å–„ä¿å­˜ã€‚å¦‚æœä¸¢å¤±ï¼Œéœ€è¦é‡æ–°åˆ›å»ºåº”ç”¨ã€‚</p>
</div>
</div></template>


